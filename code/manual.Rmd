---
title: "Manual GWAS"
author: "<h4>Author: <i>Brian M. Schilder</i></h4>"
date: "<h4>Updated: <i>`r format( Sys.Date(), '%b-%d-%Y')`</i></h4>"
output:
  BiocStyle::html_document:
vignette: >
    %\VignetteIndexEntry{OpenGWAS} 
    %\usepackage[utf8]{inputenc}
    %\VignetteEngine{knitr::rmarkdown}
---

```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE)

save_dir <- here::here("data","GWAS_munged")
source(here::here("code","utils.R"))
```

## Install deps 

```{r}
if(!require("MungeSumstats")) remotes::install_github("neurogenomics/MungeSumstats",dependencies = TRUE)
if(!require("downloadR")) remotes::install_github("RajLabMSSM/downloadR")
```


# Wightman2021 

GWAS summary stats are hosted on
the [Posthuma lab website](https://ctg.cncr.nl/software/summary_statistics).

```{r}
source(here::here("code","prepare_Wightman2021.R"))
Wightman2021 <- prepare_Wightman2021()
```
 
# Vuckovic2020

Generate weighted gene lists for each blood trait GWAS from:  
> Vuckovic D, et al. The Polygenic and Monogenic Basis of Blood Traits and Diseases. Cell. 2020 Sep 3;182(5):1214-1231.e11. [doi: 10.1016/j.cell.2020.08.008](https://doi.org/10.1016/j.cell.2020.08.008)

Data source: 
- [UK Biobank subset](ftp://ftp.sanger.ac.uk/pub/project/humgen/summary_statistics/UKBB_blood_cell_traits/): 
- [Meta-analyses (link broken)](http://www.mhi-humangenetics.org/en/resources): 746,667 subjects across 5 ancestries.
- [Trait metadata key](https://www.cell.com/cms/10.1016/j.cell.2020.08.008/attachment/ab993af6-e2f4-4681-9308-30aaa50d3953/mmc1.xlsx)

Below, we analyse only the UK Biobank subset of the results, as the link to the full meta-analyses are now broken. 

```{r}
source(here::here("code","prepare_Vuckovic2020.R"))
Vuckovic2020 <- prepare_Vuckovic2020()
```

# Copy snps2genes files

Now that all the GWAS have been mapped from SNPs to genes, 
we can copy the smaller mapping files into a folder that will 
get pushed to GitHub (i.e. isn't included in the *.gitignore* file).

```{r}
gene_files2 <- copy_snps_to_genes_files(search_dir = save_dir,
                                        save_dir = here::here("data/MAGMA_Files"), 
                                        overwrite = FALSE) 
```

<hr> 

# Session Info

<details>

```{r}
utils::sessionInfo()
```

</details>

<br>

